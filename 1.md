# leetcode sql practice
## 176.second-highest-salary

``` sql
select max(Salary) as SecondHighestSalary  from Employee
    where Salary < (select max(Salary) from Employee)
```
## 181.employees-earning-more-than-their-managers

``` sql
select 
    emp.Name as Employee
    from Employee as emp,Employee as man
        where emp.ManagerId is not null and emp.ManagerId=man.Id and emp.Salary>man.Salary
```

## 182.duplicate-emails

``` sql 
select 
    Email
    from Person 
            group by Email
                 having count(Email)>1
```

## 183.customers-who-never-order

``` sql
select 
    C.Name as Customers
        from Customers as C
            where not exists 
                (select 1 from Orders as O where C.Id=O.CustomerId)
```

## 197.rising-temperature
``` mysql
select b.Id from Weather as a
    cross join Weather as b
        where a.Temperature<b.Temperature and DateDiff(a.RecordDate,b.RecordDate)=-1
```

## 511.game-play-analysis-i
``` mysql
select player_id, min(event_date) as first_login 
from Activity
group by player_id
```

## 512.game-play-analysis-ii
```mysql 
select player_id,device_id
    from Activity where (player_id,event_date) in (
        select player_id,min(event_date) 
            from Activity 
                group by player_id) 
```

## 1068.product-sales-analysis-i
```mysql
select 
    P.product_name,S.year,S.price
    from Product as P,Sales as S
        where P.product_id=S.product_id
```

## 1069.product-sales-analysis-ii
```mysql
select product_id,sum(quantity) as total_quantity 
    from Sales
        group by product_id
```

## 595.big-countries
```mysql
select name,population,area 
    from World
        where population>25000000 or area>3000000 
select name,population,area 
    from World
        where area > 3000000
            union
select name,population,area 
    from World
        where population > 25000000;
```

## 584.find-customer-referee
```mysql
select name 
    from customer 
        where not referee_id = 2 or referee_id is null
```

## 1050.actors-and-directors-who-cooperated-at-least-three-times
```mysql
select actor_id,director_id
    from ActorDirector
            group by actor_id,director_id
                having count(`timestamp`)>=3
```
